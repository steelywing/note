"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7813],{87485:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(76687);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),i=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=i(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),g=i(n),m=o,y=g["".concat(s,".").concat(m)]||g[m]||u[m]||a;return n?r.createElement(y,l(l({ref:t},p),{},{components:n})):r.createElement(y,l({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,l=new Array(a);l[0]=g;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,l[1]=c;for(var i=2;i<a;i++)l[i]=n[i];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},76661:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>c,toc:()=>i});var r=n(76274),o=(n(76687),n(87485));const a={tags:["GoAccess","Nginx","Log","Proxy","WebSocket"]},l="GoAccess with Nginx proxy",c={permalink:"/note/blog/GoAccess with Nginx proxy",source:"@site/blog/GoAccess with Nginx proxy.md",title:"GoAccess with Nginx proxy",description:"Setup GoAccess WebSocket with Nginx proxy",date:"2023-05-18T04:42:13.000Z",formattedDate:"May 18, 2023",tags:[{label:"GoAccess",permalink:"/note/blog/tags/go-access"},{label:"Nginx",permalink:"/note/blog/tags/nginx"},{label:"Log",permalink:"/note/blog/tags/log"},{label:"Proxy",permalink:"/note/blog/tags/proxy"},{label:"WebSocket",permalink:"/note/blog/tags/web-socket"}],readingTime:.625,hasTruncateMarker:!0,authors:[],frontMatter:{tags:["GoAccess","Nginx","Log","Proxy","WebSocket"]},prevItem:{title:"FortiGate deep inspection",permalink:"/note/blog/FortiGate deep inspection"},nextItem:{title:"K6 metrics",permalink:"/note/blog/K6 metrics"}},s={authorsImageUrls:[]},i=[{value:"GoAccess",id:"goaccess",level:2},{value:"Install",id:"install",level:2},{value:"Real-time web output",id:"real-time-web-output",level:2}],p={toc:i};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Setup GoAccess WebSocket with Nginx proxy"),(0,o.kt)("h2",{id:"goaccess"},"GoAccess"),(0,o.kt)("p",null,"Web log analyzer"),(0,o.kt)("h2",{id:"install"},"Install"),(0,o.kt)("p",null,"CentOS"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Install dependency\nsudo yum -y install epel-release\nsudo yum -y update\nsudo yum -y install ncurses-devel gcc\n\n# Optional dependency\nsudo yum -y install geoip-devel tokyocabinet-devel\n\n# Download source\nwget https://tar.goaccess.io/goaccess-1.6.2.tar.gz\ntar -zxf goaccess-1.6.2.tar.gz\n\n# Build\ncd goaccess-1.6.2\n./configure --enable-utf8 --enable-geoip=mmdb\nmake\nmake install\n")),(0,o.kt)("h2",{id:"real-time-web-output"},"Real-time web output"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"goaccess \n    -o /var/www/html/report/index.html\n    --log-format=COMBINED\n    --real-time-html\n\n    # For WebSocket proxy\n    --ws-url=ws://<server IP address>:80/ws/\n\n    /var/log/nginx/access.log\n")),(0,o.kt)("p",null,"Nginx proxy"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Ref: ",(0,o.kt)("a",{parentName:"p",href:"https://www.nginx.com/blog/websocket-nginx/"},"Nginx WebSocket"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-nginx"},'server {\n    listen 80;\n    server_name example.com;\n\n    location / {\n        root /usr/share/nginx/html/;\n        # ...\n    }\n\n    # Proxy WebSocket /ws/ to localhost:7890/\n    location /ws/ {\n        proxy_pass http://localhost:7890/;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "Upgrade";\n        proxy_set_header Host $host;\n    }\n}\n')))}u.isMDXComponent=!0}}]);