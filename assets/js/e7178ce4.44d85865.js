"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[8561],{83030:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>d});var s=l(75366),a=l(26192);const i={},t="MySQL",r={id:"Note/MySQL/README",title:"MySQL",description:"Show tables size",source:"@site/docs/Note/MySQL/README.md",sourceDirName:"Note/MySQL",slug:"/Note/MySQL/",permalink:"/note/Note/MySQL/",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Note/MySQL/README.md",tags:[],version:"current",frontMatter:{},sidebar:"note",previous:{title:"Mobile",permalink:"/note/Note/Mobile"},next:{title:"Dump / Export / Import",permalink:"/note/Note/MySQL/Dump"}},c={},d=[{value:"Show tables size",id:"show-tables-size",level:2},{value:"Calculate age",id:"calculate-age",level:2},{value:"Find in set",id:"find-in-set",level:2},{value:"Insert large number of row",id:"insert-large-number-of-row",level:2},{value:"Recovery",id:"recovery",level:2},{value:"Check tables",id:"check-tables",level:3},{value:"Repair tables",id:"repair-tables",level:3},{value:"Rebuild / Reorganize index",id:"rebuild--reorganize-index",level:3},{value:"Config file",id:"config-file",level:2},{value:"Help",id:"help",level:2},{value:"Explain",id:"explain",level:2},{value:"Database",id:"database",level:2},{value:"create database",id:"create-database",level:3},{value:"drop database",id:"drop-database",level:3},{value:"Table",id:"table",level:2},{value:"list tables",id:"list-tables",level:3},{value:"show table structure",id:"show-table-structure",level:3},{value:"show create table statement",id:"show-create-table-statement",level:3},{value:"Display results vertically",id:"display-results-vertically",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"mysql",children:"MySQL"}),"\n",(0,s.jsx)(n.h2,{id:"show-tables-size",children:"Show tables size"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"select \n    table_schema as `Database`, \n    table_name as `Table`, \n    round(((DATA_LENGTH + INDEX_LENGTH) / 1024 / 1024), 2) `Size (MiB)` \nfrom INFORMATION_SCHEMA.TABLES;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"calculate-age",children:"Calculate age"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- <birth> = YYYY-MM-DD\nselect timeStampDiff(year, <birth>, curDate()) as age;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"find-in-set",children:"Find in set"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"select \n  find_in_set('B', 'A,B,C'), \n  find_in_set('D', 'A,B,C'); \n-- Return 2, 0\n"})}),"\n",(0,s.jsx)(n.h2,{id:"insert-large-number-of-row",children:"Insert large number of row"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/5.6/en/optimizing-innodb-transaction-management.html",children:"Reference"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"START TRANSACTION"})," and ",(0,s.jsx)(n.code,{children:"COMMIT"})]}),"\n",(0,s.jsx)(n.h2,{id:"recovery",children:"Recovery"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/5.5/en/forcing-innodb-recovery.html",children:"Reference"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Edit option file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"[mysqld]\ninnodb_force_recovery = 1\n"})}),"\n",(0,s.jsx)(n.p,{children:"If the log loops with"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"InnoDB: Waiting for the background threads to start\n"})}),"\n",(0,s.jsx)(n.p,{children:"Edit option file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"[mysqld]\ninnodb_purge_threads = 0\n"})}),"\n",(0,s.jsx)(n.h3,{id:"check-tables",children:"Check tables"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mysqlcheck [{ -c | --check }] [-u <user>] [-p] <database> [<table> [...]]\n"})}),"\n",(0,s.jsx)(n.p,{children:"or"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"check table <table> [, ...]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"repair-tables",children:"Repair tables"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mysqlcheck [{ -r | --repair }] [-u <user>] [-p] <database> [<table> [...]]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"rebuild--reorganize-index",children:"Rebuild / Reorganize index"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"optimize table <table> [, ...];\n"})}),"\n",(0,s.jsx)(n.h2,{id:"config-file",children:"Config file"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/option-files.html",children:"Reference"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",metastring:'title="/etc/my.cnf"',children:'# <comment>\n; <comment>\n\n[<group>]\n\n[mysqld]\n# Option for mysqld command\n\n[mysql]\n# Option for mysql command\n\n[mysqladmin]\n# Option for mysqladmin command\n\n[client]\n# Option for client (mysql, mysqldump, ...)\nport=<port>\npassword=<password>\n\n<option>\n# This is equivalent to --<option> on the command line\n\n<option>=<value>\n# This is equivalent to --<option>=<value> on the command line\n\n!include <file>\n# include config file\n\n!includedir <dir>\n# include config file "*.cnf" in <dir>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"help",children:"Help"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"{ help | ? } [<command>];\n"})}),"\n",(0,s.jsx)(n.h2,{id:"explain",children:"Explain"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.sitepoint.com/mysql-performance-indexes-explain/",children:"Reference"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Optimizing query"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"explain { select ... | delete ... | ... }\n"})}),"\n",(0,s.jsx)(n.h2,{id:"database",children:"Database"}),"\n",(0,s.jsx)(n.h3,{id:"create-database",children:"create database"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"create database <database>;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"drop-database",children:"drop database"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"drop database <database>;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"table",children:"Table"}),"\n",(0,s.jsx)(n.h3,{id:"list-tables",children:"list tables"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"show tables;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"show-table-structure",children:"show table structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"describe <table>;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"show-create-table-statement",children:"show create table statement"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"show create table <table>;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"display-results-vertically",children:"Display results vertically"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"\\G"})," instead of ",(0,s.jsx)(n.code,{children:";"})," semicolon"]})]})}function h(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},26192:(e,n,l)=>{l.d(n,{Z:()=>r,a:()=>t});var s=l(97049);const a={},i=s.createContext(a);function t(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);