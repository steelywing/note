"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1813],{80809:(e,l,n)=>{n.r(l),n.d(l,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>a});var s=n(75366),r=n(26192);const i={},c="PowerShell",o={id:"Windows/PowerShell/README",title:"PowerShell",description:"Help",source:"@site/docs/Windows/PowerShell/README.md",sourceDirName:"Windows/PowerShell",slug:"/Windows/PowerShell/",permalink:"/note/Windows/PowerShell/",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Windows/PowerShell/README.md",tags:[],version:"current",frontMatter:{},sidebar:"windows",previous:{title:"Network",permalink:"/note/Windows/Network"},next:{title:"Array",permalink:"/note/Windows/PowerShell/Array"}},t={},a=[{value:"Help",id:"help",level:2},{value:"List",id:"list",level:2},{value:"Alias",id:"alias",level:2},{value:"Property",id:"property",level:2},{value:"Filter object",id:"filter-object",level:2},{value:"Filter with file size",id:"filter-with-file-size",level:3},{value:"PowerShell remoting",id:"powershell-remoting",level:2},{value:"Trusted host",id:"trusted-host",level:2},{value:"Get credential from user input",id:"get-credential-from-user-input",level:2},{value:"PowerShell session",id:"powershell-session",level:2},{value:"Get drive",id:"get-drive",level:2},{value:"Run command",id:"run-command",level:2},{value:"Execution policies",id:"execution-policies",level:2},{value:"Unblock script",id:"unblock-script",level:2},{value:"History",id:"history",level:2},{value:"Hash table",id:"hash-table",level:2},{value:"Path",id:"path",level:2},{value:"Get system directory",id:"get-system-directory",level:2},{value:"List Windows Features",id:"list-windows-features",level:3},{value:"Clear MRU",id:"clear-mru",level:2},{value:"Get route for IP address",id:"get-route-for-ip-address",level:2},{value:"Multi-Line",id:"multi-line",level:2},{value:"Run without / hide console",id:"run-without--hide-console",level:2},{value:"Function",id:"function",level:2},{value:"Parameter",id:"parameter",level:3}];function d(e){const l={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.h1,{id:"powershell",children:"PowerShell"}),"\n",(0,s.jsx)(l.h2,{id:"help",children:"Help"}),"\n",(0,s.jsxs)(l.p,{children:[(0,s.jsx)(l.code,{children:"help"})," equal ",(0,s.jsx)(l.code,{children:"Get-Help | more"})]}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-Help [<cmdlet>]\n    [ -ShowWindow ]\n    [ -Detailed | -Full | -Examples ]\n"})}),"\n",(0,s.jsx)(l.p,{children:"Get command info"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-Command <command>\n"})}),"\n",(0,s.jsxs)(l.blockquote,{children:["\n",(0,s.jsxs)(l.p,{children:["Alias: ",(0,s.jsx)(l.code,{children:"gcm"})]}),"\n"]}),"\n",(0,s.jsx)(l.p,{children:"PowerShell version"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"$PSVersionTable\n"})}),"\n",(0,s.jsx)(l.h2,{id:"list",children:"List"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"<expression>[, ...]\n"})}),"\n",(0,s.jsx)(l.h2,{id:"alias",children:"Alias"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-Alias [[-Name] <alias> | -Definition <cmdlet>]\n"})}),"\n",(0,s.jsx)(l.h2,{id:"property",children:"Property"}),"\n",(0,s.jsx)(l.p,{children:"Get the properties and methods of objects"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"<cmdlet> | Get-Member\n"})}),"\n",(0,s.jsxs)(l.blockquote,{children:["\n",(0,s.jsxs)(l.p,{children:["Alias: ",(0,s.jsx)(l.code,{children:"gm"})]}),"\n"]}),"\n",(0,s.jsx)(l.p,{children:"Select property"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"<command> | Select-Object [[-Property] <property[]>]\n"})}),"\n",(0,s.jsxs)(l.blockquote,{children:["\n",(0,s.jsxs)(l.p,{children:["Alias: ",(0,s.jsx)(l.code,{children:"select"})]}),"\n"]}),"\n",(0,s.jsx)(l.p,{children:"Expand property"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"<command> | Select-Object -ExpandProperty <property>\n"})}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"(<command>).<property>\n"})}),"\n",(0,s.jsx)(l.p,{children:"Create property"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:'<command> | Select-Object @{N[ame]="<property name>"; E[xpression]={<expression>}}\n'})}),"\n",(0,s.jsx)(l.h2,{id:"filter-object",children:"Filter object"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"<command> | Where-Object [-FilterScript] { <Script> }\n\n# Example\n1, 2, 3, 4, 5, 6 | ? { $_ % 2 -eq 0 }\n# 2 4 6\n"})}),"\n",(0,s.jsxs)(l.blockquote,{children:["\n",(0,s.jsxs)(l.p,{children:["Alias: ",(0,s.jsx)(l.code,{children:"?"})]}),"\n"]}),"\n",(0,s.jsx)(l.h3,{id:"filter-with-file-size",children:"Filter with file size"}),"\n",(0,s.jsx)(l.p,{children:"List file with file size > 2GB"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"ls | ? { $_.Length -gt 2gb }\n"})}),"\n",(0,s.jsx)(l.h2,{id:"powershell-remoting",children:"PowerShell remoting"}),"\n",(0,s.jsx)(l.p,{children:"Enable PowerShell remoting"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Enable-PSRemoting [-SkipNetworkProfileCheck] [-Force]\n"})}),"\n",(0,s.jsx)(l.h2,{id:"trusted-host",children:"Trusted host"}),"\n",(0,s.jsx)(l.p,{children:"Get trusted host"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"winrm get winrm/config/client\n"})}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-Item WSMan:\\localhost\\Client\\TrustedHosts\n"})}),"\n",(0,s.jsx)(l.p,{children:"Set trusted host"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:'winrm set winrm/config/client @{TrustedHosts="<host>[,<host>]"}\n'})}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:'# <host> = <IP> | <hostname> | *\nSet-Item WSMan:\\localhost\\Client\\TrustedHosts -Value "<host>[,<host>]" [-Force]\n'})}),"\n",(0,s.jsx)(l.h2,{id:"get-credential-from-user-input",children:"Get credential from user input"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-Credential [[-UserName] <username>]\n"})}),"\n",(0,s.jsx)(l.h2,{id:"powershell-session",children:"PowerShell session"}),"\n",(0,s.jsx)(l.p,{children:"Create PowerShell session"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"$<variable> = New-PSSession\n    [[-ComputerName] <host[]>]\n    [-Credential { <user> | <credential> }]\n"})}),"\n",(0,s.jsx)(l.p,{children:"Connect to remote PowerShell"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Enter-PSSession\n    [-ComputerName] <host>\n    [-Credential { <user> | <credential> }]\n"})}),"\n",(0,s.jsx)(l.h2,{id:"get-drive",children:"Get drive"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-PSDrive\n"})}),"\n",(0,s.jsx)(l.h2,{id:"run-command",children:"Run command"}),"\n",(0,s.jsx)(l.p,{children:(0,s.jsx)(l.a,{href:"https://social.technet.microsoft.com/wiki/contents/articles/7703.powershell-running-executables.aspx#The_Call_Operator_amp",children:"Referense"})}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Invoke-Command [[-ComputerName] <host[]>]\n    [-ScriptBlock] <ScriptBlock>\n    [-Credential <PSCredential>]\n    [-ArgumentList <argument[]>]\n"})}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"& <ScriptBlock> [<argument[]>]\n"})}),"\n",(0,s.jsx)(l.h2,{id:"execution-policies",children:"Execution policies"}),"\n",(0,s.jsxs)(l.blockquote,{children:["\n",(0,s.jsxs)(l.p,{children:["Ref: ",(0,s.jsx)(l.a,{href:"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-6",children:"about_Execution_Policies"})]}),"\n"]}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-ExecutionPolicy\nSet-ExecutionPolicy <policy>\n"})}),"\n",(0,s.jsx)(l.h2,{id:"unblock-script",children:"Unblock script"}),"\n",(0,s.jsx)(l.p,{children:"Unblock script that was downloaded from the Internet"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Unblock-File <path>\n"})}),"\n",(0,s.jsx)(l.h2,{id:"history",children:"History"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-History\n"})}),"\n",(0,s.jsxs)(l.blockquote,{children:["\n",(0,s.jsxs)(l.p,{children:["Alias: ",(0,s.jsx)(l.code,{children:"history"})]}),"\n"]}),"\n",(0,s.jsx)(l.p,{children:"Search history"}),"\n",(0,s.jsx)("kbd",{children:"Ctrl + R"}),"\n",(0,s.jsx)(l.p,{children:"Get all session history"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-Content (Get-PSReadlineOption).HistorySavePath\n"})}),"\n",(0,s.jsx)(l.h2,{id:"hash-table",children:"Hash table"}),"\n",(0,s.jsxs)(l.blockquote,{children:["\n",(0,s.jsxs)(l.p,{children:["Ref: ",(0,s.jsx)(l.a,{href:"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_hash_tables",children:"about_Hash_Tables"})]}),"\n"]}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"$hash = @{\n    <name> = <value>;\n    [<name> = <value>] ...\n}\n"})}),"\n",(0,s.jsx)(l.p,{children:"List keys"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"$hash.Keys\n"})}),"\n",(0,s.jsx)(l.p,{children:"List values"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"$hash.Values\n"})}),"\n",(0,s.jsx)(l.p,{children:"Add"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"$hash[<key>] = <value>\n$hash.Add(<key>, <value>)\n"})}),"\n",(0,s.jsx)(l.p,{children:"Remove"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"$hash.Remove(<key>)\n"})}),"\n",(0,s.jsx)(l.h2,{id:"path",children:"Path"}),"\n",(0,s.jsx)(l.p,{children:"Get script path"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"$Script:MyInvocation.MyCommand.Path\n"})}),"\n",(0,s.jsx)(l.p,{children:"Get file name of path"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Split-Path -Leaf <path>\n"})}),"\n",(0,s.jsx)(l.p,{children:"Get folder of path"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Split-Path <path>\n"})}),"\n",(0,s.jsx)(l.p,{children:"Join path"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Join-Path <path> <path> ...\n"})}),"\n",(0,s.jsx)(l.h2,{id:"get-system-directory",children:"Get system directory"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"[System.Environment]::SystemDirectory\n"})}),"\n",(0,s.jsx)(l.h3,{id:"list-windows-features",children:"List Windows Features"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Get-WindowsOptionalFeature -Online\n"})}),"\n",(0,s.jsx)(l.h2,{id:"clear-mru",children:"Clear MRU"}),"\n",(0,s.jsx)(l.p,{children:"MRU (Most Recently Used)"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:'sp "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\\" -Name MRUList -Type String -Value ""\n'})}),"\n",(0,s.jsx)(l.h2,{id:"get-route-for-ip-address",children:"Get route for IP address"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"Find-NetRoute -RemoteIPAddress <IP address>\n"})}),"\n",(0,s.jsx)(l.h2,{id:"multi-line",children:"Multi-Line"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"<command> `\n    <parameter> ...\n"})}),"\n",(0,s.jsx)(l.h2,{id:"run-without--hide-console",children:"Run without / hide console"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:'powershell.exe -WindowStyle Hidden -Command "<command>"\n'})}),"\n",(0,s.jsx)(l.h2,{id:"function",children:"Function"}),"\n",(0,s.jsx)(l.h3,{id:"parameter",children:"Parameter"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"function <name> [([type]$param1 [,[type]$param2])]\n{\n    <statement list>\n}\n\nfunction <name>\n{\n    param([type]$param1 [,[type]$param2])\n    <statement list>\n}\n"})}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-powershell",children:"function Add([int]$a, [int]$b) {\n    return $a + $b\n}\n"})})]})}function h(e={}){const{wrapper:l}={...(0,r.a)(),...e.components};return l?(0,s.jsx)(l,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},26192:(e,l,n)=>{n.d(l,{Z:()=>o,a:()=>c});var s=n(97049);const r={},i=s.createContext(r);function c(e){const l=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(l):{...l,...e}}),[l,e])}function o(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(i.Provider,{value:l},e.children)}}}]);