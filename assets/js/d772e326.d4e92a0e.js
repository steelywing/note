"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4171],{51811:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>a,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var t=s(75366),r=s(26192);const l={},d="NFS",i={id:"Linux/NFS",title:"NFS",description:"Network File System",source:"@site/docs/Linux/NFS.md",sourceDirName:"Linux",slug:"/Linux/NFS",permalink:"/note/Linux/NFS",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Linux/NFS.md",tags:[],version:"current",frontMatter:{},sidebar:"linux",previous:{title:"Mount",permalink:"/note/Linux/Mount"},next:{title:"NetPlan",permalink:"/note/Linux/NetPlan"}},o={},c=[{value:"NFS server",id:"nfs-server",level:2},{value:"Config",id:"config",level:3},{value:"Reload / Update <code>exports</code>",id:"reload--update-exports",level:3},{value:"Show exported NFS",id:"show-exported-nfs",level:3},{value:"NFS client",id:"nfs-client",level:2},{value:"Show NFS server exports",id:"show-nfs-server-exports",level:3},{value:"<code>mount</code> NFS",id:"mount-nfs",level:3},{value:"Auto mount at boot",id:"auto-mount-at-boot",level:3},{value:"Troubleshot",id:"troubleshot",level:2}];function h(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"nfs",children:"NFS"}),"\n",(0,t.jsx)(n.p,{children:"Network File System"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"NFS v3 only use IP address / host name to verify client"}),"\n",(0,t.jsx)(n.li,{children:"NFS v4 support IP address / Kerberos (verification / hash / encryption)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"See also"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"iSCSI"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"nfs-server",children:"NFS server"}),"\n",(0,t.jsx)(n.p,{children:"Ubuntu"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo apt update\nsudo apt install nfs-kernel-server\n"})}),"\n",(0,t.jsx)(n.p,{children:"RHEL"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo yum install nfs-utils\n"})}),"\n",(0,t.jsx)(n.h3,{id:"config",children:"Config"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",metastring:'title="/etc/exports"',children:"# <path>  <host>(<options>)  ...\n/srv/nfs  10.0.0.2(rw,sync,no_subtree_check,insecure)  10.0.1.0/24(rw,sync,no_subtree_check,insecure)\n"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Option"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"rw"})}),(0,t.jsx)(n.td,{children:"allow read and write"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"sync"})}),(0,t.jsx)(n.td,{children:"reply after the change is committed (slower, safer)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"async"})}),(0,t.jsx)(n.td,{children:"reply before the change is committed (faster, corrupted when unclean)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"no_subtree_check"})}),(0,t.jsx)(n.td,{children:"disable subtree check (less issue)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"insecure"})}),(0,t.jsx)(n.td,{children:"allow network port \u2265 1024"})]})]})]}),"\n",(0,t.jsxs)(n.h3,{id:"reload--update-exports",children:["Reload / Update ",(0,t.jsx)(n.code,{children:"exports"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"exportfs -rv\n"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{}),(0,t.jsx)(n.th,{})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"-r"})}),(0,t.jsx)(n.td,{children:"re-export all directories"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"-v"})}),(0,t.jsx)(n.td,{children:"verbose"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"show-exported-nfs",children:"Show exported NFS"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"# showmount { -e | --exports }\nshowmount -e\n"})}),"\n",(0,t.jsx)(n.h2,{id:"nfs-client",children:"NFS client"}),"\n",(0,t.jsx)(n.p,{children:"Ubuntu"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"sudo apt update\nsudo apt install nfs-common\n"})}),"\n",(0,t.jsx)(n.p,{children:"RHEL"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"yum install nfs-utils\n"})}),"\n",(0,t.jsx)(n.h3,{id:"show-nfs-server-exports",children:"Show NFS server exports"}),"\n",(0,t.jsx)(n.p,{children:"Run on client host"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"# showmount { -e | --exports } <host>\nshowmount -e 10.0.0.1\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"mount-nfs",children:[(0,t.jsx)(n.code,{children:"mount"})," NFS"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["NFS options ref: ",(0,t.jsx)(n.code,{children:"man nfs"})]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"# mount [-vv] -t nfs <host>:<path> <path>\nmount -t nfs 10.0.0.1:/srv/nfs /mnt/nfs\n\n# NFS v3\nmount -t nfs -o vers=3 10.0.0.1:/srv/nfs /mnt/nfs\n"})}),"\n",(0,t.jsx)(n.h3,{id:"auto-mount-at-boot",children:"Auto mount at boot"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["option ",(0,t.jsx)(n.code,{children:"auto"}),": auto mount when ",(0,t.jsx)(n.code,{children:"mount -a"})," (at boot time)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"defaults"})," included ",(0,t.jsx)(n.code,{children:"auto"})," option"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",metastring:'title="/etc/fstab"',children:"# <file system>  <mount point>  <type>  <options>  <dump>  <pass>\n10.0.0.1:/srv/nfs  /mnt/nfs  nfs  defaults  0  0\n\n# NFS v3\n10.0.0.1:/srv/nfs  /mnt/nfs  nfs  defaults,vers=3  0  0\n"})}),"\n",(0,t.jsx)(n.h2,{id:"troubleshot",children:"Troubleshot"}),"\n",(0,t.jsx)(n.p,{children:"Permission denied"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"mount"})," with verbose option for debug"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"mount -vvvv ...\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Check if IP address is match"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If using NFSv4, try add ",(0,t.jsx)(n.code,{children:"sec=sys"})," option to client and server"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["NFSv4.0 client connect to NFSv4.2 server need add option ",(0,t.jsx)(n.code,{children:"sec=sys"})]}),"\n"]}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},26192:(e,n,s)=>{s.d(n,{Z:()=>i,a:()=>d});var t=s(97049);const r={},l=t.createContext(r);function d(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);