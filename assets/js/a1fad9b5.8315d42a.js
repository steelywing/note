"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[843],{24216:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>a});var s=r(75366),c=r(26192);const t={},l="ESXi",o={id:"Note/ESXi",title:"ESXi",description:"Reset license",source:"@site/docs/Note/ESXi.md",sourceDirName:"Note",slug:"/Note/ESXi",permalink:"/note/Note/ESXi",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Note/ESXi.md",tags:[],version:"current",frontMatter:{},sidebar:"note",previous:{title:"Dictionary",permalink:"/note/Note/Dictionary"},next:{title:"File System",permalink:"/note/Note/FileSystem"}},i={},a=[{value:"Reset license",id:"reset-license",level:2},{value:"Cron",id:"cron",level:2},{value:"VM",id:"vm",level:2},{value:"Show all VM",id:"show-all-vm",level:3},{value:"Power on VM",id:"power-on-vm",level:3},{value:"Reboot VM",id:"reboot-vm",level:3},{value:"SSH public key",id:"ssh-public-key",level:2},{value:"Create partition table",id:"create-partition-table",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,c.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"esxi",children:"ESXi"}),"\n",(0,s.jsx)(n.h2,{id:"reset-license",children:"Reset license"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"#!/bin/sh\nrm /etc/vmware/license.cfg\ncp /etc/vmware/.#license.cfg /etc/vmware/license.cfg\n/etc/init.d/vpxa restart\n"})}),"\n",(0,s.jsx)(n.h2,{id:"cron",children:"Cron"}),"\n",(0,s.jsxs)(n.p,{children:["By default, ",(0,s.jsx)(n.code,{children:"/var/spool/cron/crontabs/root"})," is read only, use ",(0,s.jsx)(n.code,{children:":w!"})," in ",(0,s.jsx)(n.code,{children:"vi"})," to save."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"kill $(cat /var/run/crond.pid)\nvi /var/spool/cron/crontabs/root\ncrond\n"})}),"\n",(0,s.jsxs)(n.p,{children:["ESXi will overwrite cron file on boot, change ",(0,s.jsx)(n.code,{children:"/etc/rc.local.d/local.sh"})," to update cron file"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'# /etc/rc.local.d/local.sh\nkill $(cat /var/run/crond.pid)\necho "* * * * * <cron job>" >> /var/spool/cron/crontabs/root\ncrond\n'})}),"\n",(0,s.jsx)(n.h2,{id:"vm",children:"VM"}),"\n",(0,s.jsx)(n.h3,{id:"show-all-vm",children:"Show all VM"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"vim-cmd vmsvc/getallvms\n"})}),"\n",(0,s.jsx)(n.h3,{id:"power-on-vm",children:"Power on VM"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"vim-cmd vmsvc/power.on <VM ID>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"reboot-vm",children:"Reboot VM"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"vim-cmd vmsvc/power.reboot <VM ID>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"ssh-public-key",children:"SSH public key"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://kb.vmware.com/s/article/1002866",children:"Reference"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"/etc/ssh/keys-<user name>/authorized_keys\n"})}),"\n",(0,s.jsx)(n.h2,{id:"create-partition-table",children:"Create partition table"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://kb.vmware.com/s/article/1036609",children:"Reference"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'partedUtil setptbl "/vmfs/devices/disks/<device>" { msdos | gpt }\n'})})]})}function h(e={}){const{wrapper:n}={...(0,c.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},26192:(e,n,r)=>{r.d(n,{Z:()=>o,a:()=>l});var s=r(97049);const c={},t=s.createContext(c);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);