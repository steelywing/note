"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6428],{90468:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>d,toc:()=>o});var i=l(75366),s=l(26192);const a={},r="LVM",d={id:"Linux/LVM",title:"LVM",description:"Logical Volume Management",source:"@site/docs/Linux/LVM.md",sourceDirName:"Linux",slug:"/Linux/LVM",permalink:"/note/Linux/LVM",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Linux/LVM.md",tags:[],version:"current",frontMatter:{},sidebar:"linux",previous:{title:"Kernel",permalink:"/note/Linux/Kernel"},next:{title:"Log",permalink:"/note/Linux/Log"}},c={},o=[{value:"See also",id:"see-also",level:2},{value:"Config file",id:"config-file",level:2},{value:"Scan for all available devices for LVM",id:"scan-for-all-available-devices-for-lvm",level:2},{value:"Change partition type ID to LVM",id:"change-partition-type-id-to-lvm",level:2},{value:"PV (Physical Volume)",id:"pv-physical-volume",level:2},{value:"Create PV",id:"create-pv",level:3},{value:"Remove PV",id:"remove-pv",level:3},{value:"Show PV information",id:"show-pv-information",level:3},{value:"VG (Volume Group)",id:"vg-volume-group",level:2},{value:"Create VG",id:"create-vg",level:3},{value:"Add PV to VG",id:"add-pv-to-vg",level:3},{value:"Remove VG",id:"remove-vg",level:3},{value:"Show VG information",id:"show-vg-information",level:3},{value:"LV (Logical Volume)",id:"lv-logical-volume",level:2},{value:"Create LV",id:"create-lv",level:3},{value:"Show LV information",id:"show-lv-information",level:3},{value:"Remove LV",id:"remove-lv",level:3},{value:"Resize LV",id:"resize-lv",level:3},{value:"Extent LV",id:"extent-lv",level:3},{value:"Reduce LV",id:"reduce-lv",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Device <code>&lt;device&gt;</code> excluded by a filter",id:"device-device-excluded-by-a-filter",level:3},{value:"Skipping: Partition table signature found",id:"skipping-partition-table-signature-found",level:3}];function t(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"lvm",children:"LVM"}),"\n",(0,i.jsx)(n.p,{children:"Logical Volume Management"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/an-introduction-to-lvm-concepts-terminology-and-operations",children:"Tutorial"})}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-use-lvm-to-manage-storage-devices-on-ubuntu-16-04",children:"Tutorial"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See also"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"OpenZFS (Volume Manager + File System)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"config-file",children:"Config file"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"/etc/lvm/lvm.conf\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Abbreviation"}),(0,i.jsx)(n.th,{children:"Name"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"PV"}),(0,i.jsx)(n.td,{children:"Physical Volume"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"VG"}),(0,i.jsx)(n.td,{children:"Volume Group"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"LV"}),(0,i.jsx)(n.td,{children:"Logical Volume"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"LVM",src:l(93131).Z+"",width:"321",height:"170"})}),"\n",(0,i.jsx)(n.h2,{id:"scan-for-all-available-devices-for-lvm",children:"Scan for all available devices for LVM"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"lvmdiskscan\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pvscan\n"})}),"\n",(0,i.jsx)(n.h2,{id:"change-partition-type-id-to-lvm",children:"Change partition type ID to LVM"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.em,{children:"Optional"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gdisk <device>\n\nCommand (? for help): t\nPartition number (1-X): <partition>\nHex code or GUID (L to show codes, Enter = 8300): 8e00\nCommand (? for help): w\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"fdisk <device>\n\nCommand (m for help): t\nPartition type (type L to list all types): L\nPartition type (type L to list all types): <Linux LVM type ID>\nCommand (m for help): w\n"})}),"\n",(0,i.jsx)(n.h2,{id:"pv-physical-volume",children:"PV (Physical Volume)"}),"\n",(0,i.jsx)(n.h3,{id:"create-pv",children:"Create PV"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# <device> = <disk> | <partition>\npvcreate <device>[ ...]\n"})}),"\n",(0,i.jsx)(n.h3,{id:"remove-pv",children:"Remove PV"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"vgreduce <VG> <PV>\npvremove <PV>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"show-pv-information",children:"Show PV information"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pvs\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pvdisplay\n"})}),"\n",(0,i.jsx)(n.h2,{id:"vg-volume-group",children:"VG (Volume Group)"}),"\n",(0,i.jsx)(n.h3,{id:"create-vg",children:"Create VG"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"vgcreate <VG name> <PV> ...\n"})}),"\n",(0,i.jsx)(n.h3,{id:"add-pv-to-vg",children:"Add PV to VG"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"vgextend <VG name> <PV> ...\n"})}),"\n",(0,i.jsx)(n.h3,{id:"remove-vg",children:"Remove VG"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"vgremove <VG name>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"show-vg-information",children:"Show VG information"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"vgs\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"vgdisplay\n"})}),"\n",(0,i.jsx)(n.h2,{id:"lv-logical-volume",children:"LV (Logical Volume)"}),"\n",(0,i.jsx)(n.h3,{id:"create-lv",children:"Create LV"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"lvcreate \n    [\n        -L <size>[K|M|G|T|P|E] |\n        -l <percent>[%{VG|FREE}]\n    ]\n    -\u2013type { linear | raid1 | raid5 | raid6 }\n    -n <LV name>\n    <VG name>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"show-lv-information",children:"Show LV information"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"lvs\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"lvdisplay\n"})}),"\n",(0,i.jsx)(n.h3,{id:"remove-lv",children:"Remove LV"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"lvremove <LV>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"resize-lv",children:"Resize LV"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"lvresize \n    {\n        { -L | --size } {+|-}<size>[K|M|G|T|P|E] |\n        { -l | --extends } {+|-}<percent>[%{VG|FREE}]\n    }\n    # Auto resize2fs\n    [ -r | --resizefs ]\n    <LV>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"extent-lv",children:"Extent LV"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"lvextend <size>"})," = ",(0,i.jsx)(n.code,{children:"lvresize +<size>"})]}),"\n",(0,i.jsx)(n.h3,{id:"reduce-lv",children:"Reduce LV"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"lvreduce <size>"})," = ",(0,i.jsx)(n.code,{children:"lvresize -<size>"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Unmount LV"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"umount <LV>\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Resize LV"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"lvresize \n  -L [-]<size>[K|M|G|T|P|E]\n  --resizefs\n  <LV>\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--resizefs"})," is similar to do the following","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Check file system"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"fsck -f <LV>\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Resize file system"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"resize2fs <LV> <size>[s|K|M|G]\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(n.h3,{id:"device-device-excluded-by-a-filter",children:["Device ",(0,i.jsx)(n.code,{children:"<device>"})," excluded by a filter"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pvcreate -vvv <device> |& grep <device>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"skipping-partition-table-signature-found",children:"Skipping: Partition table signature found"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Wipe all magic strings (BE CAREFUL!)\nwipefs --all <device>\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},93131:(e,n,l)=>{l.d(n,{Z:()=>i});const i=l.p+"assets/images/LVM-d6b1e4f73acf75e3d30e13856e0bf3f3.svg"},26192:(e,n,l)=>{l.d(n,{Z:()=>d,a:()=>r});var i=l(97049);const s={},a=i.createContext(s);function r(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);