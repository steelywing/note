(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7056],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(n),m=a,k=d["".concat(s,".").concat(m)]||d[m]||u[m]||l;return n?r.createElement(k,o(o({ref:t},c),{},{components:n})):r.createElement(k,o({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,o=new Array(l);o[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var p=2;p<l;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},490:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var r=n(2122),a=n(9756),l=(n(7294),n(3905)),o=["components"],i={id:"index",slug:".",sidebar_position:0},s="Windows",p={unversionedId:"Windows/index",id:"Windows/index",isDocsHomePage:!1,title:"Windows",description:"Recovery",source:"@site/docs/Windows/README.md",sourceDirName:"Windows",slug:"/Windows/",permalink:"/note/Windows/",editUrl:"https://github.com/steelywing/note/edit/master/docs/Windows/README.md",version:"current",sidebarPosition:0,frontMatter:{id:"index",slug:".",sidebar_position:0},sidebar:"windows",next:{title:"ACL",permalink:"/note/Windows/ACL"}},c=[{value:"Recovery",id:"recovery",children:[{value:"WinRE (Windows Recovery Environment)",id:"winre-windows-recovery-environment",children:[]},{value:"System image",id:"system-image",children:[]}]},{value:"Control panel",id:"control-panel",children:[]},{value:"Startup",id:"startup",children:[{value:"User Startup folder",id:"user-startup-folder",children:[]},{value:"All Users Startup folder",id:"all-users-startup-folder",children:[]}]},{value:"User",id:"user",children:[{value:"User Account Management / Auto Login",id:"user-account-management--auto-login",children:[]},{value:"Computer Management / Local User",id:"computer-management--local-user",children:[]},{value:"Create User",id:"create-user",children:[]},{value:"Delete User",id:"delete-user",children:[]},{value:"Make password never expire",id:"make-password-never-expire",children:[]}]},{value:"Group Policy",id:"group-policy",children:[]},{value:"Remote Desktop",id:"remote-desktop",children:[]},{value:"Hibernate",id:"hibernate",children:[]},{value:"<code>.cab</code> file",id:"cab-file",children:[]},{value:"Cortana",id:"cortana",children:[]},{value:"Allow input unicode with <kbd>Alt</kbd> + <kbd>+&lt;Code&gt;</kbd>",id:"allow-input-unicode-with-alt--code",children:[]},{value:"Enable / Disable the Local Built-In Administrator Account",id:"enable--disable-the-local-built-in-administrator-account",children:[]},{value:"Get OS Architecture (32-bit / 64-bit)",id:"get-os-architecture-32-bit--64-bit",children:[]},{value:"SLP (System Locked Pre-installation) / SLIC (System License Internal Code)",id:"slp-system-locked-pre-installation--slic-system-license-internal-code",children:[]},{value:"Code page",id:"code-page",children:[]},{value:"Cleanup",id:"cleanup",children:[{value:"Cleanup WinSxS",id:"cleanup-winsxs",children:[]},{value:"Cleanup hibernate",id:"cleanup-hibernate",children:[]}]},{value:"Disable USB storage",id:"disable-usb-storage",children:[]},{value:"Windows Features",id:"windows-features",children:[{value:"Install Windows Sandbox",id:"install-windows-sandbox",children:[]}]},{value:"Windows 11 Processor Requirements",id:"windows-11-processor-requirements",children:[]}],u={toc:c};function d(e){var t=e.components,i=(0,a.Z)(e,o);return(0,l.kt)("wrapper",(0,r.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"windows"},"Windows"),(0,l.kt)("h2",{id:"recovery"},"Recovery"),(0,l.kt)("h3",{id:"winre-windows-recovery-environment"},"WinRE (Windows Recovery Environment)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://support.microsoft.com/en-us/help/12415"},"Reference"))),(0,l.kt)("kbd",null,"Shift")," + Restart",(0,l.kt)("h3",{id:"system-image"},"System image"),(0,l.kt)("p",null,"Use to backup / restore OS"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"System image",src:n(5611).Z})),(0,l.kt)("h2",{id:"control-panel"},"Control panel"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Input ",(0,l.kt)("inlineCode",{parentName:"li"},"control panel")," in ",(0,l.kt)("inlineCode",{parentName:"li"},"Start")," search"),(0,l.kt)("li",{parentName:"ul"},"Run ",(0,l.kt)("inlineCode",{parentName:"li"},"control"))),(0,l.kt)("h2",{id:"startup"},"Startup"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://support.microsoft.com/en-us/help/4026268/windows-10-change-startup-apps"},"Reference"))),(0,l.kt)("h3",{id:"user-startup-folder"},"User Startup folder"),(0,l.kt)("p",null,"Open in ",(0,l.kt)("inlineCode",{parentName:"p"},"Run")," or Explorer"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"shell:startup\n")),(0,l.kt)("p",null,"Open in command"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"start shell:startup\n")),(0,l.kt)("h3",{id:"all-users-startup-folder"},"All Users Startup folder"),(0,l.kt)("p",null,"Open in ",(0,l.kt)("inlineCode",{parentName:"p"},"Run")," or Explorer"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"shell:common startup\n")),(0,l.kt)("p",null,"Open in PowerShell"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},'start "shell:common startup"\n')),(0,l.kt)("h2",{id:"user"},"User"),(0,l.kt)("h3",{id:"user-account-management--auto-login"},"User Account Management / Auto Login"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"netplwiz.exe\n")),(0,l.kt)("h3",{id:"computer-management--local-user"},"Computer Management / Local User"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"lusrmgr.msc\n")),(0,l.kt)("h3",{id:"create-user"},"Create User"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"net user <user name> [<password>] /add\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},"# PowerShell\nNew-LocalUser <user name> [-Password (Read-Host -AsSecureString) | -NoPassword]\n")),(0,l.kt)("h3",{id:"delete-user"},"Delete User"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"net user <user name> /delete\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},"# PowerShell\nRemove-LocalUser <user name>\n")),(0,l.kt)("h3",{id:"make-password-never-expire"},"Make password never expire"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"wmic UserAccount [where Name=<user name>] set PasswordExpires={True|False}\n")),(0,l.kt)("p",null,"Using group policy"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Computer Configuration")," > ",(0,l.kt)("inlineCode",{parentName:"p"},"Windows Settings")," > ",(0,l.kt)("inlineCode",{parentName:"p"},"Security Settings")," > ",(0,l.kt)("inlineCode",{parentName:"p"},"Password Policy")," > ",(0,l.kt)("inlineCode",{parentName:"p"},"Maximum password age")," > Set to ",(0,l.kt)("inlineCode",{parentName:"p"},"0")),(0,l.kt)("h2",{id:"group-policy"},"Group Policy"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"gpedit.msc\n")),(0,l.kt)("h2",{id:"remote-desktop"},"Remote Desktop"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Command"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Connect to remote"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"mstsc [/v:<host>[:<port>]]"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Toggle full screen"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("kbd",null,"Ctrl")," + ",(0,l.kt)("kbd",null,"Alt")," + ",(0,l.kt)("kbd",null,"Break"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"List remote desktop session"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"query session"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Attach remote desktop session to console (Screen)"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"tscon <session ID> /dest:console"))))),(0,l.kt)("h2",{id:"hibernate"},"Hibernate"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("a",{parentName:"p",href:"https://support.microsoft.com/en-us/help/920730/how-to-disable-and-re-enable-hibernation-on-a-computer-that-is-running"},"Reference"),", ",(0,l.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/powercfg-command-line-options"},"Reference"))),(0,l.kt)("p",null,"Enable / Disable hibernate (remove ",(0,l.kt)("inlineCode",{parentName:"p"},"hiberfil.sys")," file)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"powercfg { /hibernate | /h } [ on | off ]\npowercfg { /hibernate | /h } /size <percent size>\npowercfg { /hibernate | /h } /type { reduced | full }\n")),(0,l.kt)("h2",{id:"cab-file"},(0,l.kt)("inlineCode",{parentName:"h2"},".cab")," file"),(0,l.kt)("p",null,"Extract ",(0,l.kt)("inlineCode",{parentName:"p"},".cab")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"expand <file.cab>\n")),(0,l.kt)("p",null,"Create ",(0,l.kt)("inlineCode",{parentName:"p"},".cab")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"makecab <file> <file.cab>\n")),(0,l.kt)("h2",{id:"cortana"},"Cortana"),(0,l.kt)("p",null,"Disable Cortana in Windows 10"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "AllowCortana" /t REG_DWORD /d 0 /f\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},'## PowerShell\nNew-ItemProperty -Path "HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" -Name "AllowCortana" -PropertyType DWord -Value 0 -Force\n')),(0,l.kt)("p",null,"Enable Cortana in Windows 10"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},'reg delete "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "AllowCortana" /f\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},'## PowerShell\nRemove-ItemProperty -Path "HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" -Name "AllowCortana"\n')),(0,l.kt)("h2",{id:"allow-input-unicode-with-alt--code"},"Allow input unicode with ",(0,l.kt)("kbd",null,"Alt")," + ",(0,l.kt)("kbd",null,"+\\<Code",">")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://www.fileformat.info/tip/microsoft/enter_unicode.htm"},"Reference"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},'reg add "HKCU\\Control Panel\\Input Method" /v "EnableHexNumpad" /t REG_SZ /d 1 /f\n')),(0,l.kt)("h2",{id:"enable--disable-the-local-built-in-administrator-account"},"Enable / Disable the Local Built-In Administrator Account"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://social.technet.microsoft.com/wiki/contents/articles/3040.windows-7-enable-disable-the-local-built-in-administrator-account.aspx"},"Reference"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"net user administrator /active:{yes|no}\n")),(0,l.kt)("h2",{id:"get-os-architecture-32-bit--64-bit"},"Get OS Architecture (32-bit / 64-bit)"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://www.lisenet.com/2014/get-windows-system-information-via-wmi-command-line-wmic/"},"Reference"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"wmic OS get OSArchitecture\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},"## PowerShell\n(Get-CimInstance Win32_OperatingSystem).OSArchitecture\n")),(0,l.kt)("h2",{id:"slp-system-locked-pre-installation--slic-system-license-internal-code"},"SLP (System Locked Pre-installation) / SLIC (System License Internal Code)"),(0,l.kt)("p",null,"Install license"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"slmgr.vbs -ilc <path>\n")),(0,l.kt)("p",null,"Install product key"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"slmgr.vbs -ipk <product key>\n")),(0,l.kt)("h2",{id:"code-page"},"Code page"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/chcp"},"Reference"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"chcp <code page>\n")),(0,l.kt)("p",null,"Change active code page to UTF-8"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"chcp 65001\n")),(0,l.kt)("h2",{id:"cleanup"},"Cleanup"),(0,l.kt)("h3",{id:"cleanup-winsxs"},"Cleanup WinSxS"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/clean-up-the-winsxs-folder"},"Reference"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cmd"},"Dism.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase\nDism.exe /online /Cleanup-Image /SPSuperseded\n")),(0,l.kt)("h3",{id:"cleanup-hibernate"},(0,l.kt)("a",{parentName:"h3",href:"#hibernate"},"Cleanup hibernate")),(0,l.kt)("h2",{id:"disable-usb-storage"},"Disable USB storage"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://support.microsoft.com/en-ie/help/823732/how-can-i-prevent-users-from-connecting-to-a-usb-storage-device"},"Reference")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},"Set-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\ -Name Start -Value 4\n")),(0,l.kt)("p",null,"Enable USB storage"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},"Set-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\ -Name Start -Value 3\n")),(0,l.kt)("h2",{id:"windows-features"},"Windows Features"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},'& ([System.Environment]::SystemDirectory + "\\OptionalFeatures.exe")\n')),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Windows Features",src:n(9514).Z})),(0,l.kt)("h3",{id:"install-windows-sandbox"},"Install Windows Sandbox"),(0,l.kt)("p",null,"Use ",(0,l.kt)("a",{parentName:"p",href:"#windows-features"},"Windows Features")),(0,l.kt)("p",null,"or"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-powershell"},"Enable-WindowsOptionalFeature -Online -All -FeatureName Containers-DisposableClientVM\n")),(0,l.kt)("h2",{id:"windows-11-processor-requirements"},"Windows 11 Processor Requirements"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/windows-hardware/design/minimum/windows-processor-requirements"},"Reference"))),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/windows-hardware/design/minimum/supported/windows-11-supported-intel-processors"},"Supported Intel Processors")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/windows-hardware/design/minimum/supported/windows-11-supported-amd-processors"},"Supported AMD Processors"))))}d.isMDXComponent=!0},5611:function(e,t,n){"use strict";t.Z=n.p+"assets/images/system-image-50bf41cc74b20cf0ba6f990de67de904.png"},9514:function(e,t,n){"use strict";t.Z=n.p+"assets/images/windows-features-e8054548b1b9ffc24f9f07f20be7ae2a.png"}}]);