"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6368],{93180:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>o});var l=i(75366),s=i(26192);const d={},r="inode",t={id:"Linux/inode",title:"inode",description:"Ref",source:"@site/docs/Linux/inode.md",sourceDirName:"Linux",slug:"/Linux/inode",permalink:"/note/Linux/inode",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Linux/inode.md",tags:[],version:"current",frontMatter:{},sidebar:"linux",previous:{title:"find",permalink:"/note/Linux/find"},next:{title:"iptables",permalink:"/note/Linux/iptables"}},c={},o=[{value:"inode meta data",id:"inode-meta-data",level:2},{value:"inode used info",id:"inode-used-info",level:2},{value:"Show file / directory status",id:"show-file--directory-status",level:2},{value:"dirent",id:"dirent",level:2},{value:"Block size",id:"block-size",level:2},{value:"\u5728\u6a94\u6848\u4e2d\u5efa\u7acb playground file system",id:"\u5728\u6a94\u6848\u4e2d\u5efa\u7acb-playground-file-system",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"inode",children:"inode"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://zh.wikipedia.org/wiki/Inode",children:"Ref"})}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"inode \u662f file system \u4e2d\uff0c\u6a94\u6848\u7684 meta data"}),"\n",(0,l.jsx)(n.li,{children:"\u5f88\u591a file system \u7684 inode \u7e3d\u6578\u91cf\uff08\u53ef\u7528\u6578\u91cf\uff09\u5728\u5efa\u7acb\u6642\u5c31\u5df2\u56fa\u5b9a\uff0c\u6709\u4e9b\u65b0\u7684 file system \u7684 inode \u7e3d\u6578\u91cf\u53ef\u4ee5\u52d5\u614b\u589e\u52a0"}),"\n",(0,l.jsx)(n.li,{children:"\u6bcf\u500b inode \u90fd\u6709\u4e00\u500b i-number (AKA inode number)\uff0c\u5728\u540c\u4e00\u500b file system \u4e2d\u662f\u552f\u4e00\u7684"}),"\n",(0,l.jsx)(n.li,{children:"inode \u4e0d\u5305\u542b\u6a94\u6848\u540d (file name \u4fdd\u5b58\u5728 dirent)"}),"\n",(0,l.jsx)(n.li,{children:"\u5b58\u53d6\u6a94\u6848\uff1aKernel \u627e\u5230 file name \u6240\u6307\u7684 inode\uff0c\u7136\u5f8c\u5b58\u53d6 inode \u6307\u5411\u7684\u5167\u5bb9"}),"\n",(0,l.jsx)(n.li,{children:"Kernel \u6253\u958b\u6a94\u6848\u5f8c\uff0c\u5c31\u4e0d\u6703\u8a18\u4f4f file name\uff0c\u800c\u662f\u7528 inode \u5b58\u53d6\u6a94\u6848"}),"\n",(0,l.jsx)(n.li,{children:"defrag \u6642 i-number \u4e0d\u8b8a\uff0c\u53ea\u6703\u6539\u8b8a inode meta data"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"inode-meta-data",children:"inode meta data"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"inode number (i-number)"}),"\n",(0,l.jsxs)(n.li,{children:["Type","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Regular / file"}),"\n",(0,l.jsx)(n.li,{children:"Directory"}),"\n",(0,l.jsx)(n.li,{children:"Link"}),"\n",(0,l.jsx)(n.li,{children:"..."}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Mode: file permissions"}),"\n",(0,l.jsx)(n.li,{children:"Flags"}),"\n",(0,l.jsx)(n.li,{children:"Generation"}),"\n",(0,l.jsx)(n.li,{children:"Version"}),"\n",(0,l.jsx)(n.li,{children:"User: \u6a94\u6848 owner \u7684 UID"}),"\n",(0,l.jsx)(n.li,{children:"Group: \u6a94\u6848 owner \u7684 GID"}),"\n",(0,l.jsx)(n.li,{children:"Project"}),"\n",(0,l.jsx)(n.li,{children:"Size"}),"\n",(0,l.jsx)(n.li,{children:"File ACL"}),"\n",(0,l.jsx)(n.li,{children:"Links: \u6a94\u6848\u7684 hard links \u6578\u91cf"}),"\n",(0,l.jsx)(n.li,{children:"Blockcount"}),"\n",(0,l.jsx)(n.li,{children:"Fragment"}),"\n",(0,l.jsx)(n.li,{children:"ctime: creation time \u6a94\u6848\u5efa\u7acb\u7684\u6642\u9593"}),"\n",(0,l.jsx)(n.li,{children:"atime: access time \u6a94\u6848\u5b58\u53d6\u7684\u6642\u9593"}),"\n",(0,l.jsx)(n.li,{children:"mtime: modification time \u6a94\u6848\u4fee\u6539\u7684\u6642\u9593"}),"\n",(0,l.jsx)(n.li,{children:"inode checksum"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"inode-used-info",children:"inode used info"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"df -i\n"})}),"\n",(0,l.jsx)(n.h2,{id:"show-file--directory-status",children:"Show file / directory status"}),"\n",(0,l.jsx)(n.p,{children:"Include: i-number, Links (number of hard link), type, ..."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"stat <path>\n"})}),"\n",(0,l.jsx)(n.h2,{id:"dirent",children:"dirent"}),"\n",(0,l.jsx)(n.p,{children:"directory entry"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:['directory \u4e5f\u662f\u4e00\u500b "\u6a94\u6848"\uff0c"\u6a94\u6848" \u5167\u5bb9\u662f\u4e00\u500b dirent list',"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://www.kernel.org/doc/html/v5.12/filesystems/ext4/dynamic.html#linear-classic-directories",children:"dirent struct"}),":","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"i-number"}),"\n",(0,l.jsx)(n.li,{children:"file name ( inode \u7684 alias / \u5225\u540d )"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u6a94\u6848\u5167\u5bb9\u5305\u542b\uff1a","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u81ea\u5df1\u7684 dirent (",(0,l.jsx)(n.code,{children:"."}),")"]}),"\n",(0,l.jsxs)(n.li,{children:["parent \u7684 dirent (",(0,l.jsx)(n.code,{children:".."}),")"]}),"\n",(0,l.jsx)(n.li,{children:"children \u7684 dirent"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u522a\u9664\u6a94\u6848\u662f\u522a\u9664 dirent\uff0chard link \u6578\u91cf\u6e1b\u5c11 1"}),"\n",(0,l.jsx)(n.li,{children:"\u6a94\u6848\u88ab\u958b\u555f\u6642\u4e5f\u53ef\u4ee5\u522a\u9664\uff0c\u56e0\u70ba\u522a\u9664\u6a94\u6848\u53ea\u662f\u522a\u9664 dirent\uff0c\u4e0d\u5f71\u97ff inode"}),"\n",(0,l.jsxs)(n.li,{children:["unused dirent \u7684 i-number = 0 (",(0,l.jsx)(n.a,{href:"https://www.kernel.org/doc/html/v5.12/filesystems/ext4/dynamic.html#linear-classic-directories",children:"Ref"}),")"]}),"\n",(0,l.jsx)(n.li,{children:"root \u7684 i-number = 2"}),"\n",(0,l.jsx)(n.li,{children:"hard link \u662f\u6307 dirent \u6307\u5411 inode\uff0c\u5b83\u5011\u4e4b\u9593\u7684\u9023\u7d50\u95dc\u4fc2"}),"\n",(0,l.jsx)(n.li,{children:"symbolic link \u662f\u4e00\u500b type \u70ba symbolic link \u7684\u6a94\u6848\uff0c\u6a94\u6848\u5167\u5bb9\u662f\u6240\u6307 file \u7684 path (file name)"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"block-size",children:"Block size"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"blockdev --getbsz /dev/<device>\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u5728\u6a94\u6848\u4e2d\u5efa\u7acb-playground-file-system",children:"\u5728\u6a94\u6848\u4e2d\u5efa\u7acb playground file system"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# create a 1MB empty file\ntruncate -s 1M fs.ext2\n\n# create ext2 file system\nmkfs.ext2 -F fs.ext2\n\nmkdir ext2\n\n# mount the file (ext2 file system) to the mount point ext2\nmount -o loop,rw fs.ext2 ext2\n\n# show stat of inode #2\ndebugfs -R "stat <2>" fs.ext2\n\n# enter debugfs CLI\ndebugfs -w fs.ext2\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},26192:(e,n,i)=>{i.d(n,{Z:()=>t,a:()=>r});var l=i(97049);const s={},d=l.createContext(s);function r(e){const n=l.useContext(d);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(d.Provider,{value:n},e.children)}}}]);