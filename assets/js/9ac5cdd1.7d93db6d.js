"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[5959],{62509:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>a,frontMatter:()=>r,metadata:()=>l,toc:()=>o});var t=s(75366),i=s(26192);const r={},c="OpenSSL",l={id:"Note/OpenSSL/README",title:"OpenSSL",description:"File format",source:"@site/docs/Note/OpenSSL/README.md",sourceDirName:"Note/OpenSSL",slug:"/Note/OpenSSL/",permalink:"/note/Note/OpenSSL/",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Note/OpenSSL/README.md",tags:[],version:"current",frontMatter:{},sidebar:"note",previous:{title:"Excel",permalink:"/note/Note/Office/Excel"},next:{title:"Build from source",permalink:"/note/Note/OpenSSL/Build"}},d={},o=[{value:"File format",id:"file-format",level:2},{value:"PEM (Privacy-Enhanced Mail)",id:"pem-privacy-enhanced-mail",level:3},{value:"PKCS #12 (<code>.p12</code>)",id:"pkcs-12-p12",level:3},{value:"Convert <code>.pem</code> to <code>.p12</code>",id:"convert-pem-to-p12",level:3},{value:"Certificate signature",id:"certificate-signature",level:2},{value:"Option",id:"option",level:2},{value:"Version",id:"version",level:2},{value:"Test SSL/TLS connection",id:"test-ssltls-connection",level:2},{value:"Test SMTP / IMAP StartTLS",id:"test-smtp--imap-starttls",level:2},{value:"Env",id:"env",level:2},{value:"Show version",id:"show-version",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"openssl",children:"OpenSSL"}),"\n",(0,t.jsx)(n.h2,{id:"file-format",children:"File format"}),"\n",(0,t.jsx)(n.h3,{id:"pem-privacy-enhanced-mail",children:"PEM (Privacy-Enhanced Mail)"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://tools.ietf.org/html/rfc1421",children:"RFC 1421"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Use to store"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["X509 certificate (",(0,t.jsx)(n.code,{children:".crt"})," ",(0,t.jsx)(n.code,{children:".pem"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Public / private key (",(0,t.jsx)(n.code,{children:".key"})," ",(0,t.jsx)(n.code,{children:".pem"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Certificate signing request (",(0,t.jsx)(n.code,{children:".csr"})," ",(0,t.jsx)(n.code,{children:".pem"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"pkcs-12-p12",children:["PKCS #12 (",(0,t.jsx)(n.code,{children:".p12"}),")"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://tools.ietf.org/html/rfc7292",children:"RFC 7292"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Bundle X509 full chain certificate, private key"}),"\n",(0,t.jsxs)(n.h3,{id:"convert-pem-to-p12",children:["Convert ",(0,t.jsx)(n.code,{children:".pem"})," to ",(0,t.jsx)(n.code,{children:".p12"})]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://www.openssl.org/docs/manmaster/man1/openssl-pkcs12.html",children:"Reference"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'openssl pkcs12 -export\n  -in <cert.{crt|pem}>\n  [-certfile <ca.crt>]\n  -inkey <private-key.pem>\n  -out <file.p12>\n  [-passout "pass:<password>"]\n  [-name "<name>"]\n'})}),"\n",(0,t.jsx)(n.h2,{id:"certificate-signature",children:"Certificate signature"}),"\n",(0,t.jsx)(n.p,{children:"Certificate content"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Owner DN"}),"\n",(0,t.jsx)(n.li,{children:"Owner public key"}),"\n",(0,t.jsx)(n.li,{children:"CA DN"}),"\n",(0,t.jsx)(n.li,{children:"Certificate extensions"}),"\n",(0,t.jsx)(n.li,{children:"CA signature (Append after signed)"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Pseudo code\n// Content exclude signature\nCASignature = encrypt(hash(Content), CAPrivateKey)\n"})}),"\n",(0,t.jsx)(n.p,{children:"Verify signature"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Pseudo code\n// Content exclude signature\ndecrypt(CASignature, CAPublicKey) == hash(Content)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"option",children:"Option"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Option"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"-noout"})}),(0,t.jsx)(n.td,{children:"Prevents output encoded data"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"-text"})}),(0,t.jsx)(n.td,{children:"Print the data in text form"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"-modulus"})}),(0,t.jsx)(n.td,{children:"Print the modulus of public key"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"version",children:"Version"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"openssl version\n"})}),"\n",(0,t.jsx)(n.h2,{id:"test-ssltls-connection",children:"Test SSL/TLS connection"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Protocol"}),(0,t.jsx)(n.th,{children:"Port"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"HTTPS"}),(0,t.jsx)(n.td,{children:"443"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"IMAPS"}),(0,t.jsx)(n.td,{children:"993"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"IMAP STARTTLS"}),(0,t.jsx)(n.td,{children:"143"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"POP3S"}),(0,t.jsx)(n.td,{children:"995"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"SMTPS"}),(0,t.jsx)(n.td,{children:"465"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"SMTP STARTTLS"}),(0,t.jsx)(n.td,{children:"587"})]})]})]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Option"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"-showcerts"})}),(0,t.jsx)(n.td,{children:"Show full chain certificate"})]})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"openssl s_client [-showcerts] -connect <host>:<port>\n"})}),"\n",(0,t.jsx)(n.p,{children:"Show SSL certificate"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"openssl s_client -connect <host>:<port> | openssl x509 [-noout] [-text]\n"})}),"\n",(0,t.jsx)(n.h2,{id:"test-smtp--imap-starttls",children:"Test SMTP / IMAP StartTLS"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"openssl s_client -starttls { smtp | imap | pop3 } -showcerts -connect <host>:<port> -servername <domain>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"env",children:"Env"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"OPENSSL_CONF=<openssl.cnf>\n"})}),"\n",(0,t.jsx)(n.p,{children:"Same as"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"openssl ... -config <openssl.cnf>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"show-version",children:"Show version"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"openssl version\n"})})]})}function a(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},26192:(e,n,s)=>{s.d(n,{Z:()=>l,a:()=>c});var t=s(97049);const i={},r=t.createContext(i);function c(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);