"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6844],{55601:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var i=t(75366),r=t(26192);const s={date:new Date("2023-01-17T00:00:00.000Z"),tags:["FortiGate","Firewall","Network"]},l="FortiGate deep inspection",o={permalink:"/note/blog/FortiGate deep inspection",source:"@site/blog/FortiGate deep inspection.md",title:"FortiGate deep inspection",description:"Deep Inspection without SSL/TLS offload",date:"2023-01-17T00:00:00.000Z",formattedDate:"January 17, 2023",tags:[{label:"FortiGate",permalink:"/note/blog/tags/forti-gate"},{label:"Firewall",permalink:"/note/blog/tags/firewall"},{label:"Network",permalink:"/note/blog/tags/network"}],readingTime:1.01,hasTruncateMarker:!0,authors:[],frontMatter:{date:"2023-01-17T00:00:00.000Z",tags:["FortiGate","Firewall","Network"]},unlisted:!1,prevItem:{title:"FortiGate Virtual IP",permalink:"/note/blog/FortiGate Virtual IP"},nextItem:{title:"WireShark long-term traffic capture",permalink:"/note/blog/WireShark dumpcap"}},c={authorsImageUrls:[]},d=[{value:"Deep Inspection without SSL/TLS offload",id:"deep-inspection-without-ssltls-offload",level:2},{value:"Testing IPS",id:"testing-ips",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"deep-inspection-without-ssltls-offload",children:"Deep Inspection without SSL/TLS offload"}),"\n",(0,i.jsx)(n.p,{children:"Import the Web Server TLS certificate"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["In ",(0,i.jsx)(n.strong,{children:"System"})," > ",(0,i.jsx)(n.strong,{children:"Certificates"})]}),"\n",(0,i.jsxs)(n.li,{children:["Import ",(0,i.jsx)(n.strong,{children:"Certificate"})," and ",(0,i.jsx)(n.strong,{children:"Key"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Create inspection profile"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["In ",(0,i.jsx)(n.strong,{children:"Security Profiles"})," > ",(0,i.jsx)(n.strong,{children:"SSL/SSH Inspection"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create New"})]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.strong,{children:"Name"})," to ",(0,i.jsx)(n.strong,{children:"HTTPS Deep Inspection"})]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.strong,{children:"Enable SSL inspection of"})," to ",(0,i.jsx)(n.strong,{children:"Protecting SSL Server"})]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.strong,{children:"Server certificate"})," to the imported certificate"]}),"\n",(0,i.jsxs)(n.li,{children:["Enable ",(0,i.jsx)(n.strong,{children:"HTTPS"})," in ",(0,i.jsx)(n.strong,{children:"Protocol Port Mapping"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"OK"})]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"If the certificate / key is not correct, FortiGate cannot decrypt the content, then FortiGate just pass the traffic"})}),"\n",(0,i.jsx)(n.p,{children:"Enable IPS in policy"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["In ",(0,i.jsx)(n.strong,{children:"Policy & Objects"})]}),"\n",(0,i.jsx)(n.li,{children:"Edit the port forward policy"}),"\n",(0,i.jsxs)(n.li,{children:["Enable ",(0,i.jsx)(n.strong,{children:"IPS"})]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.strong,{children:"SSL Inspection"})," to ",(0,i.jsx)(n.strong,{children:"HTTPS Deep Inspection"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"testing-ips",children:"Testing IPS"}),"\n",(0,i.jsx)(n.p,{children:"Add Eicar signature"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["In ",(0,i.jsx)(n.strong,{children:"Security Profiles"})," > ",(0,i.jsx)(n.strong,{children:"Intrusion Prevention"})]}),"\n",(0,i.jsx)(n.li,{children:"Edit profile"}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create New"})]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.strong,{children:"Type"})," to ",(0,i.jsx)(n.strong,{children:"Signature"})]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.strong,{children:"Action"})," to ",(0,i.jsx)(n.strong,{children:"Block"})]}),"\n",(0,i.jsxs)(n.li,{children:["Search ",(0,i.jsx)(n.strong,{children:"Eicar"})]}),"\n",(0,i.jsxs)(n.li,{children:["Add ",(0,i.jsx)(n.strong,{children:"Eicar.Virus.Test.File"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"OK"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Trigger IPS"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Download ",(0,i.jsx)(n.a,{href:"https://www.eicar.org/download-anti-malware-testfile/",children:"Eicar test file"})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:'language-title="eicar.com.txt"',children:"X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Upload the Eicar test file to web server"}),"\n",(0,i.jsx)(n.li,{children:"Open the Eicar test file URL in browser to trigger IPS"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Check the log"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["See in ",(0,i.jsx)(n.strong,{children:"Log & Report"})," > ",(0,i.jsx)(n.strong,{children:"Intrusion Prevention"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},26192:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>l});var i=t(97049);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);