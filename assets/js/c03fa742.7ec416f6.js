"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[2103],{58047:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>x,frontMatter:()=>d,metadata:()=>i,toc:()=>h});var n=s(75366),r=s(26192);const d={},c="TCP Dump",i={id:"Linux/tcpdump",title:"TCP Dump",description:"Dump network traffic / packet",source:"@site/docs/Linux/tcpdump.md",sourceDirName:"Linux",slug:"/Linux/tcpdump",permalink:"/note/Linux/tcpdump",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Linux/tcpdump.md",tags:[],version:"current",frontMatter:{},sidebar:"linux",previous:{title:"systemd",permalink:"/note/Linux/systemd"},next:{title:"tmux",permalink:"/note/Linux/tmux"}},l={},h=[{value:"List interface",id:"list-interface",level:2},{value:"Dump traffic",id:"dump-traffic",level:2}];function o(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"tcp-dump",children:"TCP Dump"}),"\n",(0,n.jsx)(t.p,{children:"Dump network traffic / packet"}),"\n",(0,n.jsx)(t.h2,{id:"list-interface",children:"List interface"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"tcpdump { -D | --list-interfaces }\n"})}),"\n",(0,n.jsx)(t.h2,{id:"dump-traffic",children:"Dump traffic"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"tcpdump [<option>] [<expression>]\n"})}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Option"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-i {<interface>|any}"})}),(0,n.jsxs)(t.td,{children:["Listen on interface",(0,n.jsx)("br",{}),"Default: lowest numbered of interface list"]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-n"})}),(0,n.jsx)(t.td,{children:"Not resolve hostname"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-nn"})}),(0,n.jsx)(t.td,{children:"Not resolve hostname or port"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-v"})}),(0,n.jsx)(t.td,{children:"Verbose"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-w <file.pcap>"})}),(0,n.jsx)(t.td,{children:"Write to file"})]})]})]}),"\n",(0,n.jsx)(t.p,{children:"Expression"}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://www.tcpdump.org/manpages/pcap-filter.7.html",children:"Reference"})}),"\n"]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Expression"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"[src|dst] {host|ip} [not] <host>"})}),(0,n.jsxs)(t.td,{children:["Match ",(0,n.jsx)(t.code,{children:"<host>"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"{host|ip} <host> and <host>"})}),(0,n.jsxs)(t.td,{children:["Match traffic between ",(0,n.jsx)(t.code,{children:"<host>"})," and ",(0,n.jsx)(t.code,{children:"<host>"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"[src|dst] net <IP address>[/<prefix length>]"})}),(0,n.jsx)(t.td,{children:"Match IP"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"<IP address>"})}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"<#>[.<#>[.<#>[.<#>]]]"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"[src|dst] port <port>"})}),(0,n.jsx)(t.td,{children:"Port"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"[src|dst] portrange <port>-<port>"})}),(0,n.jsx)(t.td,{children:"Port range"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"{tcp|udp|icmp}"})}),(0,n.jsx)(t.td,{children:"TCP / UDP / ICMP"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"vlan [VLAN ID]"})}),(0,n.jsxs)(t.td,{children:["VLAN",(0,n.jsx)("br",{}),"Default: all IEEE 802.1Q packet"]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"{not|!} <expression>"})}),(0,n.jsx)(t.td,{children:"not"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"<expression> { and | && } <expression>"})}),(0,n.jsx)(t.td,{children:"and"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"<expression> { or | || } <expression>"})}),(0,n.jsx)(t.td,{children:"or"})]})]})]})]})}function x(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},26192:(e,t,s)=>{s.d(t,{Z:()=>i,a:()=>c});var n=s(97049);const r={},d=n.createContext(r);function c(e){const t=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),n.createElement(d.Provider,{value:t},e.children)}}}]);