"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6369],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return f}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(n),f=a,h=d["".concat(c,".").concat(f)]||d[f]||s[f]||o;return n?r.createElement(h,i(i({ref:t},u),{},{components:n})):r.createElement(h,i({ref:t},u))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5090:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return u},default:function(){return d}});var r=n(3117),a=n(102),o=(n(7294),n(3905)),i=["components"],l={},c=void 0,p={unversionedId:"Network/Cisco/ASA",id:"Network/Cisco/ASA",title:"ASA",description:"Generate RSA key for SSH by ASDM CLI",source:"@site/docs/Network/Cisco/ASA.md",sourceDirName:"Network/Cisco",slug:"/Network/Cisco/ASA",permalink:"/note/Network/Cisco/ASA",editUrl:"https://github.com/steelywing/note/edit/master/docs/Network/Cisco/ASA.md",tags:[],version:"current",frontMatter:{},sidebar:"network",previous:{title:"WireGuard",permalink:"/note/Network/WireGuard"},next:{title:"FirePower",permalink:"/note/Network/Cisco/FirePower"}},u=[{value:"Generate RSA key for SSH by ASDM CLI",id:"generate-rsa-key-for-ssh-by-asdm-cli",children:[],level:2},{value:"SLA (Service Level Agreement) monitor",id:"sla-service-level-agreement-monitor",children:[{value:"Track route with SLA",id:"track-route-with-sla",children:[],level:3}],level:2},{value:"Event manager",id:"event-manager",children:[{value:"Manual event",id:"manual-event",children:[],level:3},{value:"Syslog event",id:"syslog-event",children:[],level:3},{value:"Periodic event",id:"periodic-event",children:[{value:"Absolute event",id:"absolute-event",children:[],level:4},{value:"Countdown event",id:"countdown-event",children:[],level:4},{value:"Watchdog event",id:"watchdog-event",children:[],level:4}],level:3},{value:"Action",id:"action",children:[],level:3},{value:"Output",id:"output",children:[],level:3},{value:"Verify applet",id:"verify-applet",children:[],level:3},{value:"Manually run applet",id:"manually-run-applet",children:[],level:3},{value:"SSH public key",id:"ssh-public-key",children:[],level:3},{value:"Auto authorization (enable) when login console (Telnet / SSH)",id:"auto-authorization-enable-when-login-console-telnet--ssh",children:[],level:3}],level:2},{value:"Threat detection",id:"threat-detection",children:[{value:"Show thread detection config",id:"show-thread-detection-config",children:[],level:3},{value:"Basic threat detection",id:"basic-threat-detection",children:[],level:3},{value:"Statistics of host",id:"statistics-of-host",children:[],level:3}],level:2},{value:"Capture",id:"capture",children:[{value:"Capture ASP drop packet",id:"capture-asp-drop-packet",children:[],level:3},{value:"Show capture",id:"show-capture",children:[],level:3},{value:"Download capture",id:"download-capture",children:[],level:3},{value:"Copy capture",id:"copy-capture",children:[],level:3}],level:2},{value:"Failover / HA",id:"failover--ha",children:[{value:"Setup Interface Monitoring",id:"setup-interface-monitoring",children:[],level:3},{value:"Force failover",id:"force-failover",children:[],level:3},{value:"Re-Sync the Config",id:"re-sync-the-config",children:[],level:3},{value:"Show failover state",id:"show-failover-state",children:[],level:3},{value:"Debug failover failed",id:"debug-failover-failed",children:[],level:3}],level:2}],s={toc:u};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"generate-rsa-key-for-ssh-by-asdm-cli"},"Generate RSA key for SSH by ASDM CLI"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config)# crypto key generate rsa [noconfirm]\n")),(0,o.kt)("h2",{id:"sla-service-level-agreement-monitor"},"SLA (Service Level Agreement) monitor"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/support/docs/security/asa-5500-x-series-next-generation-firewalls/118962-configure-asa-00.html"},"Reference")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config)# sla monitor <SLA ID>\nASA(config-sla-monitor)# type echo protocol ipIcmpEcho <IP> interface <interface>\nASA(config-sla-monitor-echo)# num-packets <number of packets>\nASA(config-sla-monitor-echo)# timeout <ms>\nASA(config-sla-monitor-echo)# threshold <ms>\nASA(config-sla-monitor-echo)# frequency <seconds>\nASA(config-sla-monitor-echo)# exit\n\nASA(config)# sla monitor schedule <SLA ID> life { forever | <seconds> } start-time now\n")),(0,o.kt)("h3",{id:"track-route-with-sla"},"Track route with SLA"),(0,o.kt)("p",null,"\u7576 ",(0,o.kt)("inlineCode",{parentName:"p"},"<SLA ID>")," \u72c0\u614b\u6b63\u5e38\u624d\u555f\u7528 route"),(0,o.kt)("p",null,"Enable route only when ",(0,o.kt)("inlineCode",{parentName:"p"},"<SLA ID>")," is OK"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config)# track <track ID> rtr <SLA ID> reachability\nASA(config)# route <interface> <IP> <netmask> <gateway> [<metric>] track <track ID>\n")),(0,o.kt)("h2",{id:"event-manager"},"Event manager"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/support/docs/security/adaptive-security-appliance-asa-software/117883-config-eem-00.html"},"Reference")),(0,o.kt)("p",null,"Execute specified command on specified event"),(0,o.kt)("p",null,"\u5728\u6307\u5b9a\u7684\u60c5\u6cc1\u4e0b\u57f7\u884c\u6307\u5b9a\u7684\u6307\u4ee4"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config)# [no] event manager applet <name>\nASA(config-applet)# [no] description <text>\n")),(0,o.kt)("h3",{id:"manual-event"},"Manual event"),(0,o.kt)("p",null,"Required for manually run"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config-applet)# [no] event none\n")),(0,o.kt)("h3",{id:"syslog-event"},"Syslog event"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config-applet)# [no] event syslog id <start ID>[-<end ID>] [occurs <times>] [period <seconds>]\n")),(0,o.kt)("h3",{id:"periodic-event"},"Periodic event"),(0,o.kt)("h4",{id:"absolute-event"},"Absolute event"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config-applet)# [no] event timer absolute time <hh:mm:ss>\n")),(0,o.kt)("h4",{id:"countdown-event"},"Countdown event"),(0,o.kt)("p",null,"Execute once only"),(0,o.kt)("p",null,"\u53ea\u57f7\u884c\u4e00\u6b21"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config-applet)# [no] event timer countdown time <seconds>\n")),(0,o.kt)("h4",{id:"watchdog-event"},"Watchdog event"),(0,o.kt)("p",null,"Repeat execute every ",(0,o.kt)("inlineCode",{parentName:"p"},"<seconds>")),(0,o.kt)("p",null,"\u6bcf\u9694 ",(0,o.kt)("inlineCode",{parentName:"p"},"<seconds>")," \u57f7\u884c"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config-applet)# [no] event timer watchdog time <seconds>\n")),(0,o.kt)("h3",{id:"action"},"Action"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'ASA(config-applet)# [no] action [<action number>] cli command "<command>"\n')),(0,o.kt)("h3",{id:"output"},"Output"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config-applet)# [no] output {\n    none |\n    console |\n    file {\n        new |\n        rotate <number> |\n        overwrite <file name> |\n        append <file name>\n    }\n}\n")),(0,o.kt)("h3",{id:"verify-applet"},"Verify applet"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA# show running-config event manager\n")),(0,o.kt)("h3",{id:"manually-run-applet"},"Manually run applet"),(0,o.kt)("p",null,"Require configured with ",(0,o.kt)("inlineCode",{parentName:"p"},"event none")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA# event manager run <applet>\n")),(0,o.kt)("h3",{id:"ssh-public-key"},"SSH public key"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config)# username <user name> attributes\nASA(config-username)# ssh authentication publickey <public key>\n")),(0,o.kt)("h3",{id:"auto-authorization-enable-when-login-console-telnet--ssh"},"Auto authorization (enable) when login console (Telnet / SSH)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config)# aaa authorization exec LOCAL auto-enable\n")),(0,o.kt)("h2",{id:"threat-detection"},"Threat detection"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/support/docs/security/asa-5500-x-series-next-generation-firewalls/113685-asa-threat-detection.html"},"Reference")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA# show threat-detection { scanning-threat | rate | statistics [top] }\n")),(0,o.kt)("h3",{id:"show-thread-detection-config"},"Show thread detection config"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA# show running-config all threat-detection\n")),(0,o.kt)("h3",{id:"basic-threat-detection"},"Basic threat detection"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config)# [no] threat-detection basic-threat\n")),(0,o.kt)("h3",{id:"statistics-of-host"},"Statistics of host"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA(config)# threat-detection statistics host [number-of-rate <number of rate>]\n")),(0,o.kt)("h2",{id:"capture"},"Capture"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/support/docs/security/asa-5500-x-series-next-generation-firewalls/118097-configure-asa-00.html"},"Reference")),(0,o.kt)("h3",{id:"capture-asp-drop-packet"},"Capture ASP drop packet"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA# capture <capture ID> type asp-drop [real-time]\n")),(0,o.kt)("h3",{id:"show-capture"},"Show capture"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA# show capture <capture ID>\n")),(0,o.kt)("h3",{id:"download-capture"},"Download capture"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"https://<IP>/admin/capture/<capture ID>/pcap\n")),(0,o.kt)("h3",{id:"copy-capture"},"Copy capture"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ASA# copy /pcap capture:<capture ID> {tftp|scp}://<IP>\n")),(0,o.kt)("h2",{id:"failover--ha"},"Failover / HA"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/td/docs/security/asa/asa98/configuration/general/asa-98-general-config/ha-failover.html"},"Ref"))),(0,o.kt)("p",null,"Failover / High Availability"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"! Designate this unit as the primary / secondary unit\nasa(config)# failover lan unit { primary | secondary }\n\n! failover link\nasa(config)# failover lan interface folink <interface>\nasa(config)# failover interface ip folink 10.0.0.1 255.255.255.0 standby 10.0.0.2\nasa(config)# interface <interface>\nasa(config-if)# no shutdown\n\n! [Optional] Specify interface as state link\n! failover link and state link can be shared\nasa(config)# failover link folink <interface>\n! if failover link and state link are separated, need to assign IP address\nasa(config)# failover interface ip statelink 10.0.1.1 255.255.255.0 standby 10.0.1.2\n\n! Enable failover\nasa(config)# failover\n")),(0,o.kt)("h3",{id:"setup-interface-monitoring"},"Setup Interface Monitoring"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"asa(config)# [no] monitor-interface <interface>\n")),(0,o.kt)("h3",{id:"force-failover"},"Force failover"),(0,o.kt)("p",null,"On active unit"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"asa# no failover active\n")),(0,o.kt)("p",null,"Or, on standby unit"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"asa# failover active\n")),(0,o.kt)("h3",{id:"re-sync-the-config"},"Re-Sync the Config"),(0,o.kt)("p",null,"On active unit"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"asa# write standby\n")),(0,o.kt)("h3",{id:"show-failover-state"},"Show failover state"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"asa# show failover\nasa# show failover state\n")),(0,o.kt)("h3",{id:"debug-failover-failed"},"Debug failover failed"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"asa# show failover history\n")))}d.isMDXComponent=!0}}]);