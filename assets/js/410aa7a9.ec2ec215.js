"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4492],{45679:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>a,frontMatter:()=>t,metadata:()=>d,toc:()=>o});var r=s(75366),l=s(26192);const t={},i="SSH tunnel",d={id:"Linux/SSH-Tunnel",title:"SSH tunnel",description:"SSH tunnel / Port forward",source:"@site/docs/Linux/SSH-Tunnel.md",sourceDirName:"Linux",slug:"/Linux/SSH-Tunnel",permalink:"/note/Linux/SSH-Tunnel",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Linux/SSH-Tunnel.md",tags:[],version:"current",frontMatter:{},sidebar:"linux",previous:{title:"SELinux",permalink:"/note/Linux/SELinux"},next:{title:"SSH",permalink:"/note/Linux/SSH"}},c={},o=[{value:"Option",id:"option",level:2},{value:"SSH client \u27a1 SSH server",id:"ssh-client--ssh-server",level:2},{value:"SSH server \u27a1 SSH client",id:"ssh-server--ssh-client",level:2},{value:"SOCKS",id:"socks",level:2},{value:"Example",id:"example",level:2},{value:"SSH tunnel on <code>localhost</code>",id:"ssh-tunnel-on-localhost",level:3},{value:"SSH reverse tunnel",id:"ssh-reverse-tunnel",level:3}];function h(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"ssh-tunnel",children:"SSH tunnel"}),"\n",(0,r.jsx)(n.p,{children:"SSH tunnel / Port forward"}),"\n",(0,r.jsxs)(n.p,{children:["On SSH server, check ",(0,r.jsx)(n.code,{children:"AllowTcpForwarding"})," is allow (",(0,r.jsx)(n.code,{children:"yes"}),"), default is allow."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",metastring:'title="/etc/ssh/sshd_config"',children:"AllowTcpForwarding yes\n"})}),"\n",(0,r.jsx)(n.h2,{id:"option",children:"Option"}),"\n",(0,r.jsx)(n.p,{children:"On SSH client"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ssh [<option>] [<user>@]<SSH remote server host>\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"-N"})}),(0,r.jsx)(n.td,{children:"Do not execute a remote command"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"-f"})}),(0,r.jsx)(n.td,{children:"Run in background"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"-p <port>"})}),(0,r.jsx)(n.td,{children:"Port to connect to on the remote host"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"ssh-client--ssh-server",children:"SSH client \u27a1 SSH server"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"-L [<SSH client bind address>:]<SSH client port>:<remote server host>:<remote server port>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Port forward from ",(0,r.jsx)(n.code,{children:"<SSH client port>"})," to ",(0,r.jsx)(n.code,{children:"<remote server host>:<remote server port>"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If bind address is empty or ",(0,r.jsx)(n.code,{children:"*"})," (",(0,r.jsx)(n.code,{children:"[*]:<port>:<host>:<port>"}),"), will bind to all interfaces."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"ssh-server--ssh-client",children:"SSH server \u27a1 SSH client"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"-R [<SSH server bind address>:]<SSH server port>:<local server host>:<local server port>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Port forward from ",(0,r.jsx)(n.code,{children:"<SSH server port>"})," to ",(0,r.jsx)(n.code,{children:"<local server host>:<local server port>"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["If bind address is empty or ",(0,r.jsx)(n.code,{children:"*"})," (",(0,r.jsx)(n.code,{children:"[*]:<port>:<host>:<port>"}),"), will bind to all interfaces."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["If no bind address colon (",(0,r.jsx)(n.code,{children:"<port>:<host>:<port>"}),"), will bind to loopback interface."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"socks",children:"SOCKS"}),"\n",(0,r.jsx)(n.p,{children:"Dynamic forward from local to remote"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ssh -D [<local bind address>:]<local port> <user>@<SSH server>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SSH Tunnel",src:s(12508).Z+"",width:"696",height:"352"})}),"\n",(0,r.jsxs)(n.p,{children:["Forward ",(0,r.jsx)(n.em,{children:"SSH Client TCP port"})," \u27a1 ",(0,r.jsx)(n.em,{children:"SSH Server"})," (NAT) \u27a1 ",(0,r.jsx)(n.em,{children:"Destination address port"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# SSH Client\r\nssh -L :8000:10.0.2.2:80 10.0.1.2\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["On ",(0,r.jsx)(n.em,{children:"Client"}),", open ",(0,r.jsx)(n.code,{children:"http://10.0.0.2:8000/"}),", will port forward to ",(0,r.jsx)(n.em,{children:"Remote Server"})," ",(0,r.jsx)(n.code,{children:"http://10.0.2.2:80/"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"ssh-tunnel-on-localhost",children:["SSH tunnel on ",(0,r.jsx)(n.code,{children:"localhost"})]}),"\n",(0,r.jsxs)(n.p,{children:["Forward ",(0,r.jsx)(n.em,{children:"SSH Server TCP port"})," (NAT) \u27a1 ",(0,r.jsx)(n.em,{children:"Destination address port"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# SSH Remote Server\r\nssh -L 8000:10.0.2.2:80 127.0.0.1\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["On ",(0,r.jsx)(n.em,{children:"SSH Client"}),", open ",(0,r.jsx)(n.code,{children:"http://10.0.1.2:8000/"}),", will port forward to ",(0,r.jsx)(n.em,{children:"Remote Server"})," ",(0,r.jsx)(n.code,{children:"http://10.0.2.2:80/"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"ssh-reverse-tunnel",children:"SSH reverse tunnel"}),"\n",(0,r.jsxs)(n.p,{children:["Forward ",(0,r.jsx)(n.em,{children:"SSH Server TCP port"})," \u27a1 ",(0,r.jsx)(n.em,{children:"SSH Client"})," (NAT) \u27a1 ",(0,r.jsx)(n.em,{children:"Destination address port"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"SSH Reverse Tunnel",src:s(34755).Z+"",width:"679",height:"352"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enable ",(0,r.jsx)(n.code,{children:"GatewayPorts"})," on SSH server"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# /etc/ssh/sshd_config\r\nGatewayPorts yes\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# SSH Client\r\nssh -R :8000:10.0.2.2:80 10.0.1.1\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["On ",(0,r.jsx)(n.em,{children:"SSH Server"}),", open ",(0,r.jsx)(n.code,{children:"http://127.0.0.1:8000/"})," or ",(0,r.jsx)(n.code,{children:"http://10.0.1.2:80/"}),", will port forward to ",(0,r.jsx)(n.em,{children:"Server"})," ",(0,r.jsx)(n.code,{children:"http://10.0.2.2:80/"})]}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},34755:(e,n,s)=>{s.d(n,{Z:()=>r});const r=s.p+"assets/images/SSH Reverse Tunnel-84a8291e8d6d046fc3c8f0fc31abe22a.png"},12508:(e,n,s)=>{s.d(n,{Z:()=>r});const r=s.p+"assets/images/SSH Tunnel-3c8ea31e3e91d5c9bff501d9ad88d315.png"},26192:(e,n,s)=>{s.d(n,{Z:()=>d,a:()=>i});var r=s(97049);const l={},t=r.createContext(l);function i(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);