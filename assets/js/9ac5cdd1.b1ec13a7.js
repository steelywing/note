"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[5959],{87485:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(76687);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=s(n),d=r,k=m["".concat(p,".").concat(d)]||m[d]||u[d]||l;return n?a.createElement(k,o(o({ref:t},c),{},{components:n})):a.createElement(k,o({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=m;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var s=2;s<l;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8878:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>s});var a=n(76274),r=(n(76687),n(87485));const l={},o="OpenSSL",i={unversionedId:"Note/OpenSSL/README",id:"Note/OpenSSL/README",title:"OpenSSL",description:"File format",source:"@site/docs/Note/OpenSSL/README.md",sourceDirName:"Note/OpenSSL",slug:"/Note/OpenSSL/",permalink:"/note/Note/OpenSSL/",draft:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Note/OpenSSL/README.md",tags:[],version:"current",frontMatter:{},sidebar:"note",previous:{title:"Excel",permalink:"/note/Note/Office/Excel"},next:{title:"Build from source",permalink:"/note/Note/OpenSSL/Build"}},p={},s=[{value:"File format",id:"file-format",level:2},{value:"PEM (Privacy-Enhanced Mail)",id:"pem-privacy-enhanced-mail",level:3},{value:"PKCS #12 (<code>.p12</code>)",id:"pkcs-12-p12",level:3},{value:"Convert <code>.pem</code> to <code>.p12</code>",id:"convert-pem-to-p12",level:3},{value:"Certificate signature",id:"certificate-signature",level:2},{value:"Option",id:"option",level:2},{value:"Version",id:"version",level:2},{value:"Test SSL/TLS connection",id:"test-ssltls-connection",level:2},{value:"Test SMTP / IMAP StartTLS",id:"test-smtp--imap-starttls",level:2},{value:"Env",id:"env",level:2},{value:"Show version",id:"show-version",level:2}],c={toc:s};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"openssl"},"OpenSSL"),(0,r.kt)("h2",{id:"file-format"},"File format"),(0,r.kt)("h3",{id:"pem-privacy-enhanced-mail"},"PEM (Privacy-Enhanced Mail)"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc1421"},"RFC 1421"))),(0,r.kt)("p",null,"Use to store"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"X509 certificate (",(0,r.kt)("inlineCode",{parentName:"li"},".crt")," ",(0,r.kt)("inlineCode",{parentName:"li"},".pem"),")"),(0,r.kt)("li",{parentName:"ul"},"Public / private key (",(0,r.kt)("inlineCode",{parentName:"li"},".key")," ",(0,r.kt)("inlineCode",{parentName:"li"},".pem"),")"),(0,r.kt)("li",{parentName:"ul"},"Certificate signing request (",(0,r.kt)("inlineCode",{parentName:"li"},".csr")," ",(0,r.kt)("inlineCode",{parentName:"li"},".pem"),")")),(0,r.kt)("h3",{id:"pkcs-12-p12"},"PKCS #12 (",(0,r.kt)("inlineCode",{parentName:"h3"},".p12"),")"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc7292"},"RFC 7292"))),(0,r.kt)("p",null,"Bundle X509 full chain certificate, private key"),(0,r.kt)("h3",{id:"convert-pem-to-p12"},"Convert ",(0,r.kt)("inlineCode",{parentName:"h3"},".pem")," to ",(0,r.kt)("inlineCode",{parentName:"h3"},".p12")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"https://www.openssl.org/docs/manmaster/man1/openssl-pkcs12.html"},"Reference"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'openssl pkcs12 -export\n  -in <cert.{crt|pem}>\n  [-certfile <ca.crt>]\n  -inkey <private-key.pem>\n  -out <file.p12>\n  [-passout "pass:<password>"]\n  [-name "<name>"]\n')),(0,r.kt)("h2",{id:"certificate-signature"},"Certificate signature"),(0,r.kt)("p",null,"Certificate content"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Owner DN"),(0,r.kt)("li",{parentName:"ul"},"Owner public key"),(0,r.kt)("li",{parentName:"ul"},"CA DN"),(0,r.kt)("li",{parentName:"ul"},"Certificate extensions"),(0,r.kt)("li",{parentName:"ul"},"CA signature (Append after signed)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Pseudo code\n// Content exclude signature\nCASignature = encrypt(hash(Content), CAPrivateKey)\n")),(0,r.kt)("p",null,"Verify signature"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Pseudo code\n// Content exclude signature\ndecrypt(CASignature, CAPublicKey) == hash(Content)\n")),(0,r.kt)("h2",{id:"option"},"Option"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-noout")),(0,r.kt)("td",{parentName:"tr",align:null},"Prevents output encoded data")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-text")),(0,r.kt)("td",{parentName:"tr",align:null},"Print the data in text form")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-modulus")),(0,r.kt)("td",{parentName:"tr",align:null},"Print the modulus of public key")))),(0,r.kt)("h2",{id:"version"},"Version"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"openssl version\n")),(0,r.kt)("h2",{id:"test-ssltls-connection"},"Test SSL/TLS connection"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Protocol"),(0,r.kt)("th",{parentName:"tr",align:null},"Port"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"HTTPS"),(0,r.kt)("td",{parentName:"tr",align:null},"443")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"IMAPS"),(0,r.kt)("td",{parentName:"tr",align:null},"993")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"IMAP STARTTLS"),(0,r.kt)("td",{parentName:"tr",align:null},"143")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"POP3S"),(0,r.kt)("td",{parentName:"tr",align:null},"995")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SMTPS"),(0,r.kt)("td",{parentName:"tr",align:null},"465")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"SMTP STARTTLS"),(0,r.kt)("td",{parentName:"tr",align:null},"587")))),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"-showcerts")),(0,r.kt)("td",{parentName:"tr",align:null},"Show full chain certificate")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"openssl s_client [-showcerts] -connect <host>:<port>\n")),(0,r.kt)("p",null,"Show SSL certificate"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"openssl s_client -connect <host>:<port> | openssl x509 [-noout] [-text]\n")),(0,r.kt)("h2",{id:"test-smtp--imap-starttls"},"Test SMTP / IMAP StartTLS"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"openssl s_client -starttls { smtp | imap | pop3 } -showcerts -connect <host>:<port> -servername <domain>\n")),(0,r.kt)("h2",{id:"env"},"Env"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"OPENSSL_CONF=<openssl.cnf>\n")),(0,r.kt)("p",null,"Same as"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"openssl ... -config <openssl.cnf>\n")),(0,r.kt)("h2",{id:"show-version"},"Show version"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"openssl version\n")))}u.isMDXComponent=!0}}]);