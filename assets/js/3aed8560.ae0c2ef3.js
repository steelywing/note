"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7633],{857:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var l=r(75366),t=r(26192);const o={sidebar_label:"Network"},s="Network - PowerShell",i={id:"Windows/PowerShell/Network",title:"Network - PowerShell",description:"Network profile",source:"@site/docs/Windows/PowerShell/Network.md",sourceDirName:"Windows/PowerShell",slug:"/Windows/PowerShell/Network",permalink:"/note/Windows/PowerShell/Network",draft:!1,unlisted:!1,editUrl:"https://github.com/steelywing/note/edit/master/docs/Windows/PowerShell/Network.md",tags:[],version:"current",frontMatter:{sidebar_label:"Network"},sidebar:"windows",previous:{title:"Array",permalink:"/note/Windows/PowerShell/Array"},next:{title:"Registry",permalink:"/note/Windows/PowerShell/Registry"}},a={},c=[{value:"Network profile",id:"network-profile",level:2},{value:"Show UDP listening port",id:"show-udp-listening-port",level:2},{value:"Show TCP listening port",id:"show-tcp-listening-port",level:2},{value:"Firewall",id:"firewall",level:2},{value:"VLAN",id:"vlan",level:2},{value:"Create VLAN interface",id:"create-vlan-interface",level:3},{value:"Remove VLAN interface",id:"remove-vlan-interface",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"network---powershell",children:"Network - PowerShell"}),"\n",(0,l.jsx)(n.h2,{id:"network-profile",children:"Network profile"}),"\n",(0,l.jsx)(n.p,{children:"Get network profile"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"Get-NetConnectionProfile\n"})}),"\n",(0,l.jsx)(n.p,{children:"Set network profile"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"Set-NetConnectionProfile\n    { -InterfaceIndex <ID> | -Name <name> }\n    -NetworkCategory { Private | Public }\n"})}),"\n",(0,l.jsx)(n.h2,{id:"show-udp-listening-port",children:"Show UDP listening port"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"Get-NetUDPEndpoint -LocalAddress 0.0.0.0,::1\n"})}),"\n",(0,l.jsx)(n.p,{children:"View owning process ID"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"Get-NetUDPEndpoint -LocalAddress 0.0.0.0,::1 | \n    select OwningProcess,LocalPort\n"})}),"\n",(0,l.jsx)(n.p,{children:"View owning process name"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'Get-NetUDPEndpoint -LocalAddress 0.0.0.0,::1 | \n    select LocalPort,\n    @{\n        L="Process";\n        E={(Get-Process -Id $_.OwningProcess)\n            .ProcessName}\n    }\n'})}),"\n",(0,l.jsx)(n.h2,{id:"show-tcp-listening-port",children:"Show TCP listening port"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:"Get-NetTCPConnection -State Listen [-LocalPort <port>]\n"})}),"\n",(0,l.jsx)(n.h2,{id:"firewall",children:"Firewall"}),"\n",(0,l.jsx)(n.p,{children:"Allow ICMP echo request"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'New-NetFirewallRule `\n    -DisplayName "ICMPv4 echo request" `\n    -Direction Inbound `\n    -Protocol ICMPv4 `\n    -IcmpType 8 `\n    -Action Allow\n\nNew-NetFirewallRule `\n    -DisplayName "ICMPv6 echo request" `\n    -Direction Inbound `\n    -Protocol ICMPv6 `\n    -IcmpType 8 `\n    -Action Allow\n'})}),"\n",(0,l.jsx)(n.h2,{id:"vlan",children:"VLAN"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"/note/Windows/VirtualSwitch#add-external-virtual-switch",children:"Add external virtual switch"})}),"\n",(0,l.jsx)(n.h3,{id:"create-vlan-interface",children:"Create VLAN interface"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'Add-VMNetworkAdapter -ManagementOS -Name "<name>"\nSet-VMNetworkAdapterVlan -ManagementOS -VMNetworkAdapterName "<name>" -Access -VlanId <VLAN ID>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"remove-vlan-interface",children:"Remove VLAN interface"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-powershell",children:'Remove-VMNetworkAdapter -ManagementOS -Name "<name>"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},26192:(e,n,r)=>{r.d(n,{Z:()=>i,a:()=>s});var l=r(97049);const t={},o=l.createContext(t);function s(e){const n=l.useContext(o);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),l.createElement(o.Provider,{value:n},e.children)}}}]);